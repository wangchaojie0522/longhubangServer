import"./default-fda6ade2.js";import{K as M,E as w,h as O,M as V,i as P,F as U,_ as q,f as x,I as G,g as L,B as R}from"./KInfoItem-f66e0ca0.js";import{M as I}from"./message-9e7957c5.js";import{d as j,U as Q,M as H,N as D,r as l,o as J,c as o,G as W,j as X,k as Y,l as b,m as T,q as k,s as n,O as d,Q as Z,S as ee,y as te,z as oe}from"./index-bd696793.js";const ae=j({components:{UserOutlined:Q,LockOutlined:H,KInfoItem:M},setup(){const e=D({tscode:"",pageNum:1,pageSize:10}),u=D({name:"",tscode:"",industry:"",list_date:"",remark:""}),r=l(0),F=l(t=>`共 ${t} 条`),E=l([]),K=l([{title:"基金简称",dataIndex:"name",key:"name"},{title:"基金代码",dataIndex:"tscode",key:"tscode"},{title:"投资类型",dataIndex:"fund_type",key:"fund_type"},{title:"上市日期",dataIndex:"list_date",key:"list_date"},{title:"面值",dataIndex:"p_value",key:"p_value"},{title:"起点金额(万元)",dataIndex:"issue_amount",key:"issue_amount"},{title:"操作",dataIndex:"action",key:"action"}]),C=t=>{console.log("Page: ",t),e.pageNum=t,a()},m=()=>{e.pageNum=1,a()},a=()=>{r.value=0,w.Get({tscode:e.tscode,pageNum:e.pageNum,pageSize:e.pageSize}).then(t=>{t.code==200&&(E.value=t.data,r.value=t.count)})},_=l(!1),f=l(),g=l([]),S=l([{name:"日k",id:"d"},{name:"周k",id:"w"},{name:"月k",id:"m"}]),p=l({name:"日k",id:"d"}),s=l(),v=t=>{p.value=t,s.value&&y(s.value)},y=t=>{_.value=!0,s.value=t,O.Get({tscode:t.tscode,start_date:"",end_date:""}).then(c=>{var N;if(c.code==200){let A=c.data,B=[];A.forEach(i=>{B.push([i.trade_date,i.open,i.high,i.low,i.close,i.vol,i.vol>c.volavg?1:-1])}),g.value=B,(N=f.value)==null||N.onChange(p.value.name,t.name+"("+t.tscode+")",B)}})},$=t=>{V.confirm({title:"确定要删除该条数据吗?",icon:o(W),onOk(){w.Delete({tscode:t.tscode}).then(c=>{c.code==200?(a(),I({type:"success",msg:"删除成功"})):I({type:"error",msg:c.msg})})},onCancel(){}})},h=l(!1),z=()=>{h.value=!0,P.Post().then(t=>{t.code==200?(h.value=!1,a(),I({type:"success",msg:"修改成功"})):(h.value=!1,I({type:"error",msg:t.msg}))})};return J(()=>{a()}),{formState:e,queryData:a,onTextChange:m,dataSource:E,columns:K,totals:r,formState1:u,onDelete:$,showTotal:F,onChange:C,onReloadData:z,onloadFlag:h,onInfo:y,infoVis:_,KInfoItem:f,KInfoData:g,klist:S,activeKId:p,onChangeK:v,activeItem:s}}});const ne=e=>(te("data-v-e7bf4d61"),e=e(),oe(),e),se={class:"homePageBox"},le={class:"searchBox"},ue={class:"dataBox"},de=ne(()=>k("div",{class:"kListBox"},null,-1));function ie(e,u,r,F,E,K){const C=G,m=L,a=R,_=U,f=q,g=x,S=Y("KInfoItem"),p=V;return b(),T("div",se,[k("div",le,[o(_,{layout:"inline",model:e.formState},{default:n(()=>[o(m,null,{default:n(()=>[o(C,{value:e.formState.tscode,"onUpdate:value":u[0]||(u[0]=s=>e.formState.tscode=s),onChange:e.onTextChange,placeholder:"基金代码"},null,8,["value","onChange"])]),_:1}),o(m,null,{default:n(()=>[o(a,{type:"primary",onClick:e.queryData},{default:n(()=>[d(" 查询 ")]),_:1},8,["onClick"])]),_:1}),o(m,null,{default:n(()=>[o(a,{type:"primary",onClick:e.onReloadData,loading:e.onloadFlag},{default:n(()=>[d(" 更新数据库 ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["model"])]),k("div",ue,[o(f,{dataSource:e.dataSource,columns:e.columns,pagination:!1,size:"small"},{bodyCell:n(({column:s,record:v})=>[s.key==="action"?(b(),T(Z,{key:0},[o(a,{type:"link",onClick:y=>e.onInfo(v),style:{"margin-rigth":"20px"}},{default:n(()=>[d("K线图")]),_:2},1032,["onClick"]),o(a,{type:"link",danger:"",onClick:y=>e.onDelete(v)},{default:n(()=>[d("删除")]),_:2},1032,["onClick"])],64)):ee("",!0)]),_:1},8,["dataSource","columns"]),o(g,{class:"paginationBox",current:e.formState.pageNum,"onUpdate:current":u[1]||(u[1]=s=>e.formState.pageNum=s),"show-quick-jumper":"",total:e.totals,onChange:e.onChange,pageSizeOptions:["10","20","50","100"],"show-total":e.showTotal},null,8,["current","total","onChange","show-total"])]),o(p,{visible:e.infoVis,"onUpdate:visible":u[2]||(u[2]=s=>e.infoVis=s),width:"80vw",title:"K线图"},{footer:n(()=>[o(a,null,{default:n(()=>[d("上一页")]),_:1}),o(a,{type:"primary"},{default:n(()=>[d("上一条")]),_:1}),o(a,null,{default:n(()=>[d("下一条")]),_:1}),o(a,{type:"primary"},{default:n(()=>[d("下一页")]),_:1})]),default:n(()=>[k("div",null,[de,o(S,{ref:"KInfoItem",style:{height:"70vh"}},null,512)])]),_:1},8,["visible"])])}const _e=X(ae,[["render",ie],["__scopeId","data-v-e7bf4d61"]]);export{_e as default};
